<?php

namespace PatrolSdk;

class Exploit extends PatrolModel {

    // @var integer A Exploit object is always a child of a Software object
    protected $software_id;

    // @var integer An Exploit object is related to a Server
    protected $server_id;

    /**
     * Set the software id manually
     *
     * @param integer $software_id
     */
    public function setSoftwareId($software_id) {
        $this->software_id = $software_id;
    }

    /**
     * Set the server id manually
     *
     * @param integer $server_id
     */
    public function setServerId($server_id) {
        $this->server_id = $server_id;
    }

    /**
     * Gets a list of all exploits of this particular software
     *
     * @param array $scopes optional
     *
     * @return array List of PatrolSdk\Exploit
     */
    public function all($scopes = []) {
        return $this->_get('servers/' . $this->server_id . '/software/' . $this->software_id . '/exploits', null, $scopes);
    }

}
